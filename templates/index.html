<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ü–∏—Ñ—Ä</title>
    <style>
        /* –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ */
        :root {
            --bg-color: #1a1a1a;
            --canvas-bg: #000000;
            --text-color: #ffffff;
            --accent-color: #4caf50;
            --button-hover: #388e3c;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            padding: 2rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            text-align: center;
            color: var(--accent-color);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .container {
            background: #2a2a2a;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        canvas {
            width: 200px;
            height: 200px;
            background-color: var(--canvas-bg);
            border: 2px solid var(--accent-color);
            cursor: crosshair;
            margin-bottom: 1rem;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        button {
            flex: 1 1 auto;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            background-color: var(--accent-color);
            color: white;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        button:hover {
            background-color: var(--button-hover);
            transform: scale(1.05);
        }

        #result {
            margin-top: 1.5rem;
            font-size: 1.5rem;
            color: var(--accent-color);
            min-height: 2rem;
            transition: opacity 0.3s ease;
        }

        @media (max-width: 600px) {
            canvas {
                width: 150px;
                height: 150px;
            }

            button {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <h1>–ù–∞—Ä–∏—Å—É–π—Ç–µ —Ü–∏—Ñ—Ä—É</h1>
    <div class="container">
        <canvas id="canvas" width="200" height="200"></canvas>
        <div class="buttons">
            <button id="predictBtn">üîç –†–∞—Å–ø–æ–∑–Ω–∞—Ç—å</button>
            <button id="clearBtn">üßπ –û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        <div id="result"></div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;
        let lastX = 0;
        let lastY = 0;

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∏—Å—Ç–∏
        ctx.strokeStyle = 'white';
        ctx.lineWidth = 10;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—á–∞–ª–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
        canvas.addEventListener('mousedown', (e) => {
            drawing = true;
            [lastX, lastY] = [e.offsetX, e.offsetY];
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è
        canvas.addEventListener('mouseup', () => {
            drawing = false;
            ctx.closePath();
        });

        canvas.addEventListener('mouseout', () => {
            drawing = false;
            ctx.closePath();
        });

        // –û—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
        canvas.addEventListener('mousemove', (e) => {
            if (!drawing) return;

            const currentX = e.offsetX;
            const currentY = e.offsetY;

            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(currentX, currentY);
            ctx.stroke();

            [lastX, lastY] = [currentX, currentY];
        });

        // –û—á–∏—Å—Ç–∫–∞ canvas
        document.getElementById('clearBtn').addEventListener('click', () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            document.getElementById('result').textContent = '';
        });

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        document.getElementById('predictBtn').addEventListener('click', () => {
            const imageData = canvas.toDataURL('image/png'); // –ü–æ–ª—É—á–µ–Ω–∏–µ base64
            fetch('/predict', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({image: imageData})
            })
            .then(response => response.json())
            .then(data => {
                const resultDiv = document.getElementById('result');
                if (data.error) {
                    resultDiv.textContent = '–û—à–∏–±–∫–∞: ' + data.error;
                    resultDiv.style.color = 'red';
                } else {
                    resultDiv.textContent = `–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–∞—è —Ü–∏—Ñ—Ä–∞: ${data.digit}`;
                    resultDiv.style.color = 'var(--accent-color)';
                }
            });
        });
    </script>
</body>
</html>